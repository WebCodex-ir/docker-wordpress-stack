# استک داکر وردپرس با عملکرد بالا

این پروژه یک قالب آماده و حرفه‌ای برای راه‌اندازی یک سایت وردپرسی بسیار سریع، امن و بهینه با استفاده از Docker است. تمام فرآیندها برای نصب آسان و سریع، خودکار شده‌اند.

## معماری 🏗️

این استک از بهترین ابزارهای مدرن برای اجرای وردپرس استفاده می‌کند:
* **Reverse Proxy:** **Traefik** (برای مسیریابی هوشمند و مدیریت خودکار SSL)
* **وب سرور:** **Nginx** (برای سرویس‌دهی به فایل‌های وردپرس و ارتباط با PHP)
* **اپلیکیشن:** **WordPress** (اجرا شده روی آخرین نسخه PHP-FPM)
* **دیتابیس:** **MariaDB** (جایگزین سریع‌تر و بهینه‌تر MySQL)
* **کشینگ:** **Redis** (برای کش آبجکت‌ها و افزایش چشمگیر سرعت)

## پیش‌نیازها 📋

1.  یک سرور با سیستم عامل **Ubuntu 22.04 / 24.04**.
2.  یک **دامنه** که Nameserver های آن روی **Cloudflare** تنظیم شده باشد.
3.  یک **توکن API از کلودفلر** (Cloudflare API Token) با دسترسی `Edit zone DNS`.

## راهنمای راه‌اندازی 🚀

ابتدا مراحل آماده‌سازی سرور را انجام دهید، سپس بسته به نیاز خود یکی از دو سناریوی زیر را دنبال کنید.

#### **آماده‌سازی اولیه سرور**

با SSH به سرور خود متصل شوید و این ریپازیتوری را کلون کنید:
```bash
git clone https://github.com/WebCodex-ir/docker-wordpress-stack.git
cd docker-wordpress-stack
````

سپس فایل پیکربندی را آماده کنید:

```bash
# فایل نمونه را کپی کنید
cp .env.example .env

# فایل را با اطلاعات خود ویرایش کنید
nano .env
```

در فایل `.env`، مقادیر `DOMAIN_NAME`، `CLOUDFLARE_EMAIL`، `CLOUDFLARE_DNS_API_TOKEN` و رمزهای عبور دیتابیس را با دقت پر کنید. در نهایت، اسکریپت نصب را قابل اجرا کنید:

```bash
chmod +x install.sh
```

-----

### **سناریو اول: انتقال یک سایت وردپرسی موجود**

اگر می‌خواهید یک سایت وردپرسی که از قبل دارید را به این سرور منتقل کنید، این مراحل را دنبال کنید.

1.  **ساخت پکیج در سایت قدیمی:**

      * در سایت **قدیمی** خود، افزونه رایگان **Duplicator** را نصب کنید.
      * از منوی Duplicator به بخش **Packages** بروید و یک پکیج جدید بسازید.
      * دو فایل **Installer** (`installer.php`) و **Archive** (`.zip`) را روی کامپیوتر خود دانلود کنید.

2.  **راه‌اندازی سرور جدید:**

      * در ترمینال سرور، اسکریپت نصب را اجرا کنید تا یک وردپرس خالی راه‌اندازی شود.
        ```bash
        sudo ./install.sh
        ```

3.  **آپلود فایل‌های انتقال:**

      * دو فایلی که دانلود کرده بودید (`installer.php` و `.zip`) را به پوشه `./data/wordpress/` روی سرور جدید آپلود کنید.

4.  **اجرای نصب‌کننده Duplicator:**

      * در کلودفلر، مطمئن شوید که رکورد `A` دامنه شما به IP سرور اشاره می‌کند و حالت SSL روی **Full (Strict)** است.
      * به آدرس `https://your-domain.com/installer.php` بروید.
      * در بخش Database، اطلاعات دیتابیس را از فایل `.env` خود وارد کنید (Host را `mariadb` قرار دهید) و مراحل را تا انتها دنبال کنید.

5.  **ورود و پاک‌سازی:**

      * با نام کاربری و رمز عبور سایت **قدیمی** خود وارد پیشخوان شوید.
      * فایل‌های نصب‌کننده Duplicator را طبق درخواست خود افزونه پاک کنید.
      * به **تنظیمات \> پیوندهای یکتا** بروید و دو بار روی دکمه **"ذخیره تغییرات"** کلیک کنید.

-----

### **سناریو دوم: نصب یک وردپرس خام و جدید**

اگر می‌خواهید یک سایت جدید را از صفر شروع کنید، این مراحل را دنبال کنید.

1.  **راه‌اندازی سرور:**

      * در ترمینال سرور (پس از انجام مراحل آماده‌سازی اولیه)، اسکریپت نصب را اجرا کنید.
        ```bash
        sudo ./install.sh
        ```

2.  **تنظیمات DNS در کلودفلر:**

      * در کلودفلر، یک رکورد `A` برای دامنه خود بسازید که به **IP سرور شما** اشاره کند و مطمئن شوید ابر نارنجی **فعال** است.
      * به تب `SSL/TLS` بروید و حالت رمزنگاری را روی **Full (Strict)** قرار دهید.

3.  **نصب وردپرس:**

      * پس از چند دقیقه، به آدرس دامنه خود `https://your-domain.com` بروید.
      * شما صفحه معروف نصب ۵ دقیقه‌ای وردپرس را خواهید دید.
      * زبان خود را انتخاب کرده و در مرحله بعد، عنوان سایت، نام کاربری و رمز عبور مدیر را مشخص کنید و وردپرس را نصب کنید.

**تبریک\! سایت جدید شما آماده استفاده است.**

## دستورات مدیریتی ⚙️

  * **مشاهده تمام کانتینرهای در حال اجرا:** `sudo docker ps`
  * **مشاهده لاگ‌های یک سرویس:** `sudo docker compose logs -f <service_name>`
  * **متوقف کردن تمام سرویس‌ها:** `sudo docker compose down`
  * **شروع مجدد تمام سرویس‌ها:** `sudo docker compose up -d`

<!-- end list -->
