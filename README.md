# ุงุณุชฺฉ ุฏุงฺฉุฑ ูุฑุฏูพุฑุณ ุจุง ุนููฺฉุฑุฏ ุจุงูุง

ุงู ูพุฑูฺู ฺฉ ูุงูุจ ุขูุงุฏู ู ุญุฑููโุง ุจุฑุง ุฑุงูโุงูุฏุงุฒ ฺฉ ุง ฺูุฏ ุณุงุช ูุฑุฏูพุฑุณ ุจุณุงุฑ ุณุฑุนุ ุงูู ู ุจููู ุจุง ุงุณุชูุงุฏู ุงุฒ Docker ุงุณุช. ุชูุงู ูุฑุขูุฏูุง ุจุฑุง ูุตุจ ุขุณุงู ู ุณุฑุนุ ุฎูุฏฺฉุงุฑ ุดุฏูโุงูุฏ.

## ูุนูุงุฑ ๐๏ธ

ุงู ุงุณุชฺฉ ุงุฒ ุจูุชุฑู ุงุจุฒุงุฑูุง ูุฏุฑู ุจุฑุง ุงุฌุฑุง ูุฑุฏูพุฑุณ ุงุณุชูุงุฏู ูโฺฉูุฏ:
* **Reverse Proxy:** **Traefik** (ุจุฑุง ูุณุฑุงุจ ููุดููุฏ ู ูุฏุฑุช ุฎูุฏฺฉุงุฑ SSL)
* **ูุจ ุณุฑูุฑ:** **Nginx** (ุจุฑุง ุณุฑูุณโุฏู ุจู ูุงูโูุง ูุฑุฏูพุฑุณ ู ุงุฑุชุจุงุท ุจุง PHP)
* **ุงูพูฺฉุดู:** **WordPress** (ุงุฌุฑุง ุดุฏู ุฑู ุขุฎุฑู ูุณุฎู PHP-FPM)
* **ุฏุชุงุจุณ:** **MariaDB** (ุฌุงฺฏุฒู ุณุฑุนโุชุฑ ู ุจูููโุชุฑ MySQL)
* **ฺฉุดูฺฏ:** **Redis** (ุจุฑุง ฺฉุด ุขุจุฌฺฉุชโูุง ู ุงูุฒุงุด ฺุดูฺฏุฑ ุณุฑุนุช)
* **ฺฉูุชุฑู ูพูู:** **Portainer** (ุฑุงุจุท ฺฏุฑุงูฺฉ ุจุฑุง ูุฏุฑุช ุฏุงฺฉุฑ)

## ูพุดโูุงุฒูุง ๐

1.  ฺฉ ุณุฑูุฑ ุจุง ุณุณุชู ุนุงูู **Ubuntu 22.04 / 24.04**.
2.  ฺฉ **ุฏุงููู** ฺฉู Nameserver ูุง ุขู ุฑู **Cloudflare** ุชูุธู ุดุฏู ุจุงุดุฏ.
3.  ฺฉ **ุชูฺฉู API ุงุฒ ฺฉููุฏููุฑ** (Cloudflare API Token) ุจุง ุฏุณุชุฑุณ `Edit zone DNS`.

## ุฑุงูููุง ุฑุงูโุงูุฏุงุฒ ุงููู ๐

ุงู ูุฑุงุญู ุณุฑูุฑ ุดูุง ุฑุง ุจุฑุง ูุฒุจุงู ุณุงุชโูุง ุขูุงุฏู ูโฺฉูุฏ.

#### **ฑ. ุขูุงุฏูโุณุงุฒ ุงููู ุณุฑูุฑ**

ุจุง SSH ุจู ุณุฑูุฑ ุฎูุฏ ูุชุตู ุดูุฏ ู ุงู ุฑูพุงุฒุชูุฑ ุฑุง ฺฉููู ฺฉูุฏ:
```bash
git clone [https://github.com/WebCodex-ir/docker-wordpress-stack.git](https://github.com/WebCodex-ir/docker-wordpress-stack.git)
cd docker-wordpress-stack
````

ุณูพุณ ูุงู ูพฺฉุฑุจูุฏ ุฑุง ุขูุงุฏู ฺฉูุฏ:

```bash
# ูุงู ููููู ุฑุง ฺฉูพ ฺฉูุฏ
cp .env.example .env

# ูุงู ุฑุง ุจุง ุงุทูุงุนุงุช ุฎูุฏ ูุฑุงุด ฺฉูุฏ
nano .env
```

ุฏุฑ ูุงู `.env`ุ ุชูุงู ููุงุฏุฑ (`DOMAIN_NAME`, `CLOUDFLARE_EMAIL`, `CLOUDFLARE_DNS_API_TOKEN` ู ุฑูุฒูุง ุนุจูุฑ ุฏุชุงุจุณ) ุฑุง ุจุง ุฏูุช ูพุฑ ฺฉูุฏ. ุฏุฑ ููุงุชุ ุงุณฺฉุฑูพุช ูุตุจ ุฑุง ูุงุจู ุงุฌุฑุง ฺฉูุฏ:

```bash
chmod +x install.sh
```

#### **ฒ. ุงุฌุฑุง ุงุณฺฉุฑูพุช ูุตุจ**

ุงุณฺฉุฑูพุช ุฑุง ุงุฌุฑุง ฺฉูุฏ. ุงู ุงุณฺฉุฑูพุช ุฏุงฺฉุฑุ ูพูุฑุชูุฑ ู ุณุงุฑ ูุงุฒููุฏโูุง ุฑุง ูุตุจ ฺฉุฑุฏู ู ฺฉ ูุฑุฏูพุฑุณ ุฎุงู ุฑุงูโุงูุฏุงุฒ ูโฺฉูุฏ.

```bash
sudo ./install.sh
```

ูพุณ ุงุฒ ุงุชูุงูุ ฺฉ ูุฑุฏูพุฑุณ ุฎุงู ุฑู ุฏุงููู ุงุตู ุดูุง ุฏุฑ ุฏุณุชุฑุณ ุงุณุช ฺฉู ูโุชูุงูุฏ ุขู ุฑุง ูุตุจ ฺฉุฑุฏู ุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฑุงูููุง ุฒุฑุ ุณุงุช ูุฏู ุฎูุฏ ุฑุง ุจู ุขู ููุชูู ฺฉูุฏ.

-----

## ูุฏุฑุช ูพุดุฑูุชู ุณุฑูุฑ ๐๏ธ

ุฏุฑ ุงุฏุงูู ูุญูู ูุฏุฑุชุ ุชูุณุนู ู ูฺฏูุฏุงุฑ ุณุฑูุฑ ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช.

### **ุงูุฒูุฏู ฺฉ ุณุงุจโุฏุงูู ุฌุฏุฏ**

ูุฑุถ ฺฉูุฏ ูโุฎูุงูู ฺฉ ุณุงุช ุงุณุชุงุชฺฉ ุณุงุฏู ุฑู ุณุงุจโุฏุงูู `test.sialkplast.ir` ุงุถุงูู ฺฉูู.

1.  **ุชูุธู DNS:** ุฏุฑ ฺฉููุฏููุฑุ ฺฉ ุฑฺฉูุฑุฏ `A` ุฌุฏุฏ ุจุฑุง ุณุงุจโุฏุงูู `test` ุจุณุงุฒุฏ ฺฉู ุจู IP ุณุฑูุฑ ุดูุง ุงุดุงุฑู ฺฉูุฏ.
2.  **ูุฑุงุด `docker-compose.yml`:** ูุงู `docker-compose.yml` ุฑุง ุจุงุฒ ฺฉุฑุฏู ู ุณุฑูุณ ุฌุฏุฏ ุฒุฑ ุฑุง ุจู ุงูุชูุง ุขู (ููโุณุทุญ ุจุง ุณุฑูุณโูุง ุฏฺฏุฑ) ุงุถุงูู ฺฉูุฏ:
    ```yaml
    
      test-site:
        image: httpd:alpine
        container_name: test-site
        restart: unless-stopped
        labels:
          - "traefik.enable=true"
          - "traefik.http.routers.test-site.rule=Host(`test.sialkplast.ir`)"
          - "traefik.http.routers.test-site.entrypoints=websecure"
          - "traefik.http.routers.test-site.tls=true"
          - "traefik.http.routers.test-site.tls.certresolver=cloudflare"
    ```
3.  **ุงุนูุงู ุชุบุฑุงุช:** ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ. Traefik ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุณุฑูุณ ุฌุฏุฏ ุฑุง ุดูุงุณุง ฺฉุฑุฏู ู ุจุฑุง ุขู SSL ุฏุฑุงูุช ูโฺฉูุฏ.
    ```bash
    sudo docker compose up -d
    ```

### **ุงูุฒูุฏู ฺฉ ุฏุงููู ฺฉุงููุงู ุฌุฏุฏ**

ุดูุง ูโุชูุงูุฏ ฺฉ ูุฑุฏูพุฑุณ ฺฉุงููุงู ูุฌุฒุง ุจุฑุง ฺฉ ุฏุงููู ุฌุฏุฏ (ูุซูุงู `new-domain.com`) ูุฒ ุงุถุงูู ฺฉูุฏ.

1.  **ุชูุธู DNS:** ุฏุงููู ุฌุฏุฏ ุฑุง ุจู ฺฉููุฏููุฑ ุงุถุงูู ฺฉุฑุฏู ู ฺฉ ุฑฺฉูุฑุฏ `A` ุจุฑุง ุขู ุจุณุงุฒุฏ ฺฉู ุจู IP ุณุฑูุฑ ุดูุง ุงุดุงุฑู ฺฉูุฏ.
2.  **ูุฑุงุด `docker-compose.yml`:** ุณุฑูุณโูุง ุฌุฏุฏ ุจุฑุง ูุฑุฏูพุฑุณ ู ุฏุชุงุจุณ ุฏูู ุจู ุงูุชูุง ูุงู `docker-compose.yml` ุงุถุงูู ฺฉูุฏ. **ููู ุงุณุช ฺฉู ูุงู ุณุฑูุณโูุง ู ูุณุฑ ูพูุดูโูุง ููุญุตุฑ ุจู ูุฑุฏ ุจุงุดูุฏ.**
    ```yaml
    
      # --- ุณุฑูุณโูุง ุณุงุช ุฏูู ---
      nginx_site2:
        image: nginx:stable-alpine
        restart: unless-stopped
        volumes:
          - ./data/wordpress2:/var/www/html
          - ./data/nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
        labels:
          - "traefik.enable=true"
          - "traefik.http.routers.wordpress_site2.rule=Host(`new-domain.com`)"
          - "traefik.http.routers.wordpress_site2.entrypoints=websecure"
          - "traefik.http.routers.wordpress_site2.tls=true"
          - "traefik.http.routers.wordpress_site2.tls.certresolver=cloudflare"

      wordpress_site2:
        image: wordpress:latest-fpm-alpine
        restart: unless-stopped
        volumes:
          - ./data/wordpress2:/var/www/html
        environment:
          - WORDPRESS_DB_HOST=mariadb_site2
          - WORDPRESS_DB_USER=user_site2
          - WORDPRESS_DB_PASSWORD=a_very_strong_password
          - WORDPRESS_DB_NAME=db_site2
        depends_on:
          - mariadb_site2

      mariadb_site2:
        image: mariadb:latest
        restart: unless-stopped
        volumes:
          - ./data/mariadb2:/var/lib/mysql
        environment:
          - MARIADB_ROOT_PASSWORD=another_strong_root_password
          - MARIADB_DATABASE=db_site2
          - MARIADB_USER=user_site2
          - MARIADB_PASSWORD=a_very_strong_password
    ```
3.  **ุงุนูุงู ุชุบุฑุงุช:** ุฏุณุชูุฑ `sudo docker compose up -d` ุฑุง ุงุฌุฑุง ฺฉูุฏ ุชุง ุณุงุช ุฌุฏุฏ ุฑุงูโุงูุฏุงุฒ ุดูุฏ.

-----

## ุจฺฉุงูพ ู ุจุงุฒฺฏุฑุฏุงู ๐พ

### **ฺฏุฑูุชู ุจฺฉุงูพ ฺฉุงูู**

ุจฺฉุงูพ ฺฉุงูู ุดุงูู ุฏุงุฏูโูุง (ูพูุดู `data`) ู ูพฺฉุฑุจูุฏ (ูุงูโูุง ูพุฑูฺู ุฏุฑ ฺฏุชโูุงุจ) ุงุณุช.

1.  ุจุฑุง ฺฏุฑูุชู ุจฺฉุงูพ ุงุฒ ุชูุงู ูุงูโูุง ู ุฏุชุงุจุณโูุงุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุฏุฑ ูพูุดู ุงุตู ูพุฑูฺู ุงุฌุฑุง ฺฉูุฏ:
    ```bash
    sudo tar -czvf backup-$(date +%Y-%m-%d).tar.gz ./data
    ```
2.  ุงู ุฏุณุชูุฑ ฺฉ ูุงู ูุดุฑุฏู ุจุง ูุงู `backup-YYYY-MM-DD.tar.gz` ุงุฌุงุฏ ูโฺฉูุฏ. ุงู ูุงู ุฑุง ุฏุงูููุฏ ฺฉุฑุฏู ู ุฏุฑ ุฌุง ุงูู ูฺฏูุฏุงุฑ ฺฉูุฏ.

### **ุจุงุฒฺฏุฑุฏุงู ุจฺฉุงูพ ฺฉุงูู**

ุจุฑุง ุจุงุฒฺฏุฑุฏุงู ุณุงุช ุฑู ฺฉ ุณุฑูุฑ ุฌุฏุฏ ู ุฎุงู:

1.  **ุขูุงุฏูโุณุงุฒ ุงููู:** ูพุฑูฺู ุฑุง ุงุฒ ฺฏุชโูุงุจ ุฎูุฏ `clone` ฺฉุฑุฏู ู ูุงู `.env` ุฑุง ุจุง ุงุทูุงุนุงุช ุตุญุญ ูพุฑ ฺฉูุฏ.
2.  **ุขูพููุฏ ู ุงุณุชุฎุฑุงุฌ ุจฺฉุงูพ:** ูุงู ุจฺฉุงูพ (`.tar.gz`) ุฑุง ุฏุฑ ูพูุดู ุงุตู ูพุฑูฺู ุขูพููุฏ ฺฉุฑุฏู ู ุจุง ุฏุณุชูุฑ ุฒุฑ ุขู ุฑุง ุงุฒ ุญุงูุช ูุดุฑุฏู ุฎุงุฑุฌ ฺฉูุฏ:
    ```bash
    sudo tar -xzvf your-backup-file.tar.gz
    ```
3.  **ุฑุงูโุงูุฏุงุฒ ุณุฑูุณโูุง:** ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ ุชุง ุชูุงู ุณุฑูุณโูุง ุจุง ุงุทูุงุนุงุช ุจฺฉุงูพ ุดูุง ุจุงูุง ุจุงูุฏ:
    ```bash
    sudo docker compose up -d
    ```

-----

## ุนุจโุงุจ ู ุฏุณุชูุฑุงุช ููุฏ โ๏ธ

  * **ูุดฺฉู ุฏุณุชุฑุณ ูุงูโูุง ูพุณ ุงุฒ ุงูุชูุงู:**
    ุงฺฏุฑ ุจุนุฏ ุงุฒ ุงูุชูุงู ุณุงุช ุจุง ุงูุฒููู Duplicator ุง ุจู ุตูุฑุช ุฏุณุชุ ุฏุฑ ุขูพุฏุช ุง ูุตุจ ุงูุฒูููโูุง ุจุง ุฎุทุง ุฏุณุชุฑุณ ูุงู (File Permissions) ููุงุฌู ุดุฏุฏุ ุจู ุงู ุฏูู ุงุณุช ฺฉู ูุงูฺฉุช ูุงูโูุง ุจู ูู ุฑุฎุชู ุงุณุช. ุจุง ุฏุณุชูุฑ ุฒุฑ ุขู ุฑุง ุงุตูุงุญ ฺฉูุฏ:

    ```bash
    sudo chown -R www-data:www-data ./data/wordpress/
    ```

  * **ุฏุณุชูุฑุงุช ูุฏุฑุช:**

      * **ูุดุงูุฏู ฺฉุงูุชูุฑูุง:** `sudo docker ps`
      * **ูุดุงูุฏู ูุงฺฏโูุง:** `sudo docker compose logs -f <service_name>`
      * **ูุชููู ฺฉุฑุฏู ุณุฑูุณโูุง:** `sudo docker compose down`
      * **ุดุฑูุน ูุฌุฏุฏ ุณุฑูุณโูุง:** `sudo docker compose up -d`

<!-- end list -->
